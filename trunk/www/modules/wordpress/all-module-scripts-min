Ext.namespace("GO.wordpress");var wpIframe;var wpConfig={title:GO.wordpress.lang.wordpress,iconCls:"go-tab-icon-wordpress",layout:"fit",items:[wpIframe=new GO.panel.IFrameComponent({url:GO.settings.modules.wordpress.url+"redirect.php"})],border:false,tbar:[{iconCls:"go-module-icon-wordpress",text:GO.wordpress.lang.wordpressAdmin,handler:function(){wpIframe.el.dom.contentDocument.location=GO.settings.modules.wordpress.url+"redirect.php"},scope:this}]};if(GO.settings.has_admin_permission){wpConfig.tbar.push("-",{iconCls:"btn-settings",text:GO.lang.cmdSettings,handler:function(){if(!this.adminDialog){this.adminDialog=new GO.wordpress.AdminDialog()}this.adminDialog.show()}})}GO.moduleManager.addModule("wordpress",Ext.Panel,wpConfig);GO.wordpress.PublishPanel=function(e){e=e||{};e.title=GO.wordpress.lang.websitePublish;e.layout="form";var f=new GO.plugins.HtmlEditorSpellCheck(this);var d=new Ext.ux.form.HtmlEditor.Word();var b=new Ext.ux.form.HtmlEditor.HR();var a=new Ext.ux.form.HtmlEditor.IndentOutdent();var c=new Ext.ux.form.HtmlEditor.RemoveFormat();e.items=[{xtype:"checkbox",hideLabel:true,boxLabel:"Publish to Wordpress",name:"wp_publish"},{hideLabel:true,xtype:"htmleditor",anchor:"100% -50",name:"wp_content",plugins:[f,d,b,a,c]}];GO.wordpress.PublishPanel.superclass.constructor.call(this,e)};Ext.extend(GO.wordpress.PublishPanel,Ext.Panel,{});GO.moduleManager.onModuleReady("addressbook",function(){Ext.override(GO.addressbook.ContactDialog,{initComponent:GO.addressbook.ContactDialog.prototype.initComponent.createInterceptor(function(){this.tabPanel.add(new GO.wordpress.PublishPanel())})})});GO.moduleManager.onModuleReady("projects",function(){Ext.override(GO.projects.ProjectDialog,{initComponent:GO.projects.ProjectDialog.prototype.initComponent.createInterceptor(function(){this.tabPanel.add(new GO.wordpress.PublishPanel())})})});GO.wordpress.AdminDialog=function(a){a=a||{};a.width=400;a.autoHeight=true;a.title=GO.lang.cmdSettings;this.formPanel=new Ext.FormPanel({waitMsgTarget:true,cls:"go-form-panel",url:GO.settings.modules.wordpress.url+"action.php",items:[{xtype:"textfield",fieldLabel:"Wordpress URL",name:"wp_url",anchor:"100%"}]});a.items=[this.formPanel];a.listeners={show:function(){this.formPanel.form.load({url:GO.settings.modules.wordpress.url+"json.php",waitMsg:GO.lang.waitMsgLoad})},scope:this};a.buttons=[{text:GO.lang.cmdOk,handler:function(){this.formPanel.form.submit({waitMsg:GO.lang.waitMsgSave,success:function(){this.hide()},scope:this})},scope:this}];GO.wordpress.AdminDialog.superclass.constructor.call(this,a)};Ext.extend(GO.wordpress.AdminDialog,GO.Window);