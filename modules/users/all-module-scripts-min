GO.users.UserDialog=function(a){if(!a){a={}}a.goDialogId="user";this.buildForm();a.tbar=[this.linkBrowseButton=new Ext.Button({iconCls:"btn-link",cls:"x-btn-text-icon",text:GO.lang.cmdBrowseLinks,disabled:true,handler:function(){if(!GO.linkBrowser){GO.linkBrowser=new GO.LinkBrowser()}GO.linkBrowser.show({link_id:this.user_id,link_type:"8",folder_id:"0"})},scope:this})];if(GO.files){a.tbar.push(this.fileBrowseButton=new Ext.Button({iconCls:"btn-files",cls:"x-btn-text-icon",text:GO.files.lang.files,handler:function(){GO.files.openFolder(this.files_folder_id)},scope:this,disabled:true}))}a.layout="fit";a.modal=false;a.resizable=true;a.maximizable=true;a.width=750;a.collapsible=true;a.height=580;a.closeAction="hide";a.title=GO.users.lang.userSettings;a.items=this.formPanel;a.buttons=[{text:GO.lang.cmdOk,handler:function(){this.submitForm(true)},scope:this},{text:GO.lang.cmdSavePlusNew,handler:function(){this.submitForm(false,true)},scope:this},{text:GO.lang.cmdApply,handler:function(){this.submitForm()},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}];GO.users.UserDialog.superclass.constructor.call(this,a);this.addEvents({save:true,set_id:true})};Ext.extend(GO.users.UserDialog,GO.Window,{user_id:0,files_folder_id:"",setUserId:function(a){this.formPanel.form.baseParams.user_id=a;this.user_id=a;this.permissionsTab.setUserId(a);this.accountTab.setUserId(a);if(this.serverclientFieldSet){var b=a>0;this.serverclientFieldSet.setVisible(!b)}this.loginTab.setVisible(a>0);this.linkBrowseButton.setDisabled(!a);if(GO.files){this.fileBrowseButton.setDisabled(!a)}this.lookAndFeelTab.startModuleField.clearLastSearch();this.lookAndFeelTab.modulesStore.baseParams.user_id=a;this.fireEvent("set_id",this)},serverclientDomainCheckboxes:[],setDefaultEmail:function(){if(this.rendered){for(var b=0;b<this.serverclientDomainCheckboxes.length;b++){if(this.serverclientDomainCheckboxes[b].getValue()){var c=this.formPanel.form.findField("username").getValue();var a=this.formPanel.form.findField("email");if(a){this.formPanel.form.findField("email").setValue(c+"@"+GO.serverclient.domains[b])}break}}}},show:function(a){if(GO.mailings&&!GO.mailings.writableMailingsStore.loaded){GO.mailings.writableMailingsStore.load({callback:function(){this.show(a)},scope:this});return false}if(!this.rendered){if(GO.serverclient&&GO.serverclient.domains){this.serverclientFieldSet=new Ext.form.FieldSet({title:GO.serverclient.lang.mailboxes,height:100,autoScroll:true,items:new GO.form.HtmlComponent({html:'<p class="go-form-text">'+GO.serverclient.lang.createMailbox+":</p>"})});for(var b=0;b<GO.serverclient.domains.length;b++){this.serverclientDomainCheckboxes[b]=new Ext.form.Checkbox({checked:(b==0),name:"serverclient_domains[]",autoCreate:{tag:"input",type:"checkbox",value:GO.serverclient.domains[b]},hideLabel:true,boxLabel:GO.serverclient.domains[b]});this.serverclientDomainCheckboxes[b].on("check",this.setDefaultEmail,this);this.serverclientFieldSet.add(this.serverclientDomainCheckboxes[b])}this.rightCol.add(this.serverclientFieldSet)}this.render(Ext.getBody())}if(GO.serverclient&&GO.serverclient.domains){this.formPanel.form.findField("username").on("change",this.setDefaultEmail,this)}this.profileTab.show();this.formPanel.form.reset();this.setUserId(a);if(a>0){this.formPanel.load({url:GO.settings.modules.users.url+"json.php",success:function(c,d){this.loaded=true;GO.users.UserDialog.superclass.show.call(this);this.files_folder_id=d.result.data.files_folder_id;this.lookAndFeelTab.startModuleField.setRemoteText(d.result.data.start_module_name)},failure:function(c,d){Ext.Msg.alert(GO.lang.strError,d.result.feedback)},scope:this})}else{GO.users.UserDialog.superclass.show.call(this)}},submitForm:function(a,b){var c=this.permissionsTab.getPermissionParameters();c.task="save_user";this.formPanel.form.submit({url:GO.settings.modules.users.url+"action.php",params:c,waitMsg:GO.lang.waitMsgSave,success:function(f,g){this.fireEvent("save",this,g.result.user_id||this.user_id);this.permissionsTab.commit();if(a){this.hide()}else{if(b){this.setUserId(0);var d=["username","password1","password2","first_name","middle_name","last_name","title","initials","sex","birthday","address","address_no","city","zip","email","home_phone","fax","cellular","department","function"];for(var e=0;e<d.length;e++){this.formPanel.form.findField(d[e]).reset()}this.permissionsTab.onShow()}else{if(g.result.user_id){this.setUserId(g.result.user_id);this.files_folder_id=g.result.files_folder_id}}}},failure:function(d,e){if(e.failureType=="client"){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strErrorsInForm)}else{Ext.MessageBox.alert(GO.lang.strError,e.result.feedback)}},scope:this})},buildForm:function(){this.accountTab=new GO.users.AccountPanel();this.personalTab=new Ext.form.FieldSet({title:GO.users.lang.personalProfile,items:new GO.users.PersonalPanel({cb_id:"users_countryCombo"}),autoHeight:true,layout:"fit"});this.companyTab=new GO.users.CompanyPanel({title:GO.users.lang.companyProfile,cls:"go-form-panel",cb_id:"users_work_countryCombo"});this.loginTab=new GO.users.LoginPanel();this.permissionsTab=new GO.users.PermissionsPanel();this.regionalSettingsTab=new GO.users.RegionalSettingsPanel();this.lookAndFeelTab=new GO.users.LookAndFeelPanel();this.profileTab=new Ext.Panel({title:GO.users.lang.account,autoScroll:true,layout:"column",bodyStyle:"padding:5px",items:[{columnWidth:0.5,items:[this.accountTab],bodyStyle:"padding-right:5px",border:false},this.rightCol=new Ext.Panel({columnWidth:0.5,bodyStyle:"padding-left:5px",items:[this.loginTab],border:false}),{columnWidth:1,items:[this.personalTab],border:false}]});var a=[this.profileTab,this.companyTab,this.permissionsTab,this.regionalSettingsTab,this.lookAndFeelTab];if(GO.mailings){a.push(new GO.mailings.SelectMailingsPanel({hideAllowCheck:true}))}if(GO.customfields&&GO.customfields.types["8"]){for(var b=0;b<GO.customfields.types["8"].panels.length;b++){a.push(GO.customfields.types["8"].panels[b])}}this.tabPanel=new Ext.TabPanel({deferredRender:false,anchor:"100% 100%",layoutOnTabChange:true,border:false,items:a});this.formPanel=new Ext.form.FormPanel({items:this.tabPanel,baseParams:{task:"user"},waitMsgTarget:true,border:false})}});GO.users.PermissionsPanel=function(d){if(!d){d={}}d.autoScroll=false;d.border=false;d.hideLabel=true;d.title=GO.lang.strPermissions;d.layout="columnfit";d.anchor="100% 100%";d.defaults={border:true,height:280,autoScroll:true};var f=new GO.grid.CheckColumn({header:GO.users.lang.useModule,dataIndex:"read_permission",width:55,disabled_field:"read_disabled",menuDisabled:true});var h=new GO.grid.CheckColumn({header:GO.users.lang.manageModule,dataIndex:"write_permission",width:55,disabled_field:"write_disabled",menuDisabled:true});this.modulePermissionsStore=new GO.data.JsonStore({url:GO.settings.modules.users.url+"json.php",baseParams:{user_id:-1,task:"modules"},fields:["id","name","read_disabled","write_disabled","read_permission","write_permission"],root:"results",menuDisabled:true});var c=new GO.grid.GridPanel({columnWidth:0.34,title:GO.users.lang.moduleAccess,layout:"fit",columns:[{id:"name",header:GO.users.lang.cmdHeaderColumnName,dataIndex:"name",renderer:this.iconRenderer,menuDisabled:true},f,h],ds:this.modulePermissionsStore,plugins:[f,h],autoExpandColumn:"name"});var a=new GO.grid.CheckColumn({header:"",dataIndex:"group_permission",width:55,menuDisabled:true});this.groupMemberStore=new GO.data.JsonStore({url:GO.settings.modules.users.url+"json.php",baseParams:{user_id:-1,task:"groups"},fields:["id","disabled","group","group_permission"],root:"results"});var b=new GO.grid.GridPanel({columnWidth:0.33,layout:"fit",title:GO.users.lang.userIsMemberOf,columns:[{id:"name",header:GO.users.lang.group,dataIndex:"group",menuDisabled:true},a],ds:this.groupMemberStore,plugins:a,autoExpandColumn:"name"});var g=new GO.grid.CheckColumn({header:"",dataIndex:"visible_permission",width:55,menuDisabled:true});this.groupVisibleStore=new GO.data.JsonStore({url:GO.settings.modules.users.url+"json.php",baseParams:{user_id:-1,task:"visible"},fields:["id","disabled","group","visible_permission"],root:"results"});var e=new GO.grid.GridPanel({columnWidth:0.33,layout:"fit",title:GO.users.lang.userVisibleTo,columns:[{id:"name",header:GO.users.lang.group,dataIndex:"group",menuDisabled:true},g],ds:this.groupVisibleStore,plugins:g,autoExpandColumn:"name"});d.items=[c,b,e];GO.users.PermissionsPanel.superclass.constructor.call(this,d)};Ext.extend(GO.users.PermissionsPanel,Ext.Panel,{iconRenderer:function(c,b,a){return'<div class="go-module-icon-'+a.data.id+'" style="height:16px;padding-left:22px;background-repeat:no-repeat;">'+c+"</div>"},setUserId:function(a,b){if(!this.isVisible()&&a!=this.user_id){this.groupMemberStore.removeAll();this.modulePermissionsStore.removeAll();this.groupVisibleStore.removeAll();this.modulePermissionsStore.baseParams.user_id=-1;this.groupMemberStore.baseParams.user_id=-1;this.groupVisibleStore.baseParams.user_id=-1}this.user_id=a},onShow:function(){GO.users.PermissionsPanel.superclass.onShow.call(this);if(this.groupMemberStore.baseParams.user_id!=this.user_id){this.modulePermissionsStore.baseParams.user_id=this.user_id;this.groupMemberStore.baseParams.user_id=this.user_id;this.groupVisibleStore.baseParams.user_id=this.user_id;this.groupMemberStore.load();this.modulePermissionsStore.load();this.groupVisibleStore.load()}},commit:function(){this.modulePermissionsStore.commitChanges();this.groupMemberStore.commitChanges();this.groupVisibleStore.commitChanges()},getPermissionParameters:function(){var d=new Array();var a=new Array();var b=new Array();for(var c=0;c<this.modulePermissionsStore.data.items.length;c++){d[c]={id:this.modulePermissionsStore.data.items[c].get("id"),name:this.modulePermissionsStore.data.items[c].get("name"),read_permission:this.modulePermissionsStore.data.items[c].get("read_permission"),write_permission:this.modulePermissionsStore.data.items[c].get("write_permission")}}for(var c=0;c<this.groupMemberStore.data.items.length;c++){a[c]={id:this.groupMemberStore.data.items[c].get("id"),group:this.groupMemberStore.data.items[c].get("name"),group_permission:this.groupMemberStore.data.items[c].get("group_permission")}}for(var c=0;c<this.groupVisibleStore.data.items.length;c++){b[c]={id:this.groupVisibleStore.data.items[c].get("id"),group:this.groupVisibleStore.data.items[c].get("name"),visible_permission:this.groupVisibleStore.data.items[c].get("visible_permission")}}return{modules:Ext.encode(d),groups_visible:Ext.encode(b),group_member:Ext.encode(a)}}});GO.users.LoginPanel=function(a){if(!a){a={}}a.autoHeight=true;a.border=true;a.hideLabel=true;a.title=GO.users.lang.loginInfo;a.layout="form";a.defaults={anchor:"100%"};a.defaultType="textfield";a.labelWidth=140;a.items=[{xtype:"plainfield",fieldLabel:GO.users.lang.cmdFormLabelRegistrationTime,name:"registration_time"},{xtype:"plainfield",fieldLabel:GO.users.lang.cmdFormLabelLastLogin,name:"lastlogin"},{xtype:"plainfield",fieldLabel:GO.users.lang.numberOfLogins,name:"logins"}];GO.users.LoginPanel.superclass.constructor.call(this,a)};Ext.extend(GO.users.LoginPanel,Ext.form.FieldSet,{});GO.users.AccountPanel=function(a){if(!a){a={}}a.autoHeight=true;a.border=true;a.hideLabel=true;a.title=GO.users.lang.account;a.layout="form";a.defaults={anchor:"100%"};a.defaultType="textfield";a.labelWidth=140;this.passwordField1=new Ext.form.TextField({inputType:"password",fieldLabel:GO.users.lang.cmdFormLabelPassword,name:"password1"});this.passwordField2=new Ext.form.TextField({inputType:"password",fieldLabel:GO.users.lang.confirmPassword,name:"password2"});this.usernameField=new Ext.form.TextField({fieldLabel:GO.lang.strUsername,name:"username"});this.enabledField=new Ext.form.Checkbox({boxLabel:GO.users.lang.cmdBoxLabelEnabled,name:"enabled",checked:true,hideLabel:true});this.invitationField=new Ext.form.Checkbox({boxLabel:GO.users.lang.sendInvitation,name:"send_invitation",checked:true,hideLabel:true});a.items=[this.usernameField,this.passwordField1,this.passwordField2,{xtype:"panel",hideLabel:true,border:false,bodyStyle:"padding:0",layout:"column",defaults:{bodyStyle:"padding:0",border:false,layout:"form",columnWidth:0.5},items:[{items:this.enabledField},{items:this.invitationField}]}];GO.users.AccountPanel.superclass.constructor.call(this,a)};Ext.extend(GO.users.AccountPanel,Ext.form.FieldSet,{setUserId:function(a){this.invitationField.getEl().up(".x-form-item").setDisplayed(!a);this.usernameField.setDisabled(a>0);this.passwordField2.allowBlank=(a>0);this.passwordField1.allowBlank=(a>0)}});GO.users.ImportDialog=Ext.extend(Ext.Window,{initComponent:function(){this.title=GO.lang.cmdImport;this.width=500;this.autoHeight=true;this.closeAction="hide";this.uploadFile=new GO.form.UploadFile({inputName:"importfile",max:1});this.upForm=new Ext.form.FormPanel({fileUpload:true,waitMsgTarget:true,items:[new GO.form.HtmlComponent({html:GO.users.lang.importText+"<br /><br />"}),this.uploadFile],cls:"go-form-panel"});this.items=[this.upForm];this.buttons=[{text:GO.lang.cmdOk,handler:this.uploadHandler,scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this},{text:GO.users.lang.downloadSampleCSV,handler:function(){window.open(GO.settings.modules.users.url+"download_importsample.php")},scope:this}];this.addEvents({"import":true});GO.users.ImportDialog.superclass.initComponent.call(this)},uploadHandler:function(){this.upForm.form.submit({waitMsg:GO.lang.waitMsgUpload,url:GO.settings.modules.users.url+"action.php",params:{task:"import"},success:function(b,c){this.uploadFile.clearQueue();this.hide();this.fireEvent("import");var a=c.result.feedback.replace(/BR/g,"<br />");Ext.MessageBox.alert(GO.lang.strSuccess,a)},failure:function(b,c){if(c.failureType=="client"){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strErrorsInForm)}else{var a=c.result.feedback.replace(/BR/g,"<br />");Ext.MessageBox.alert(GO.lang.strError,a)}},scope:this})}});GO.users.SettingsDialog=function(a){if(!a){a={}}this.formPanel=new Ext.form.FormPanel({border:false,waitMsgTarget:true,cls:"go-form-panel",items:[{xtype:"textfield",fieldLabel:GO.lang.strSubject,name:"register_email_subject",anchor:"100%"},{hideLabel:true,xtype:"textarea",anchor:"100% -30",name:"register_email_body"}]});a.layout="fit";a.modal=false;a.resizable=false;a.width=750;a.height=500;a.closeAction="hide";a.title=GO.lang.cmdSettings;a.items=this.formPanel;a.buttons=[{text:GO.lang.cmdOk,handler:function(){this.submitForm(true)},scope:this},{text:GO.lang.cmdClose,handler:function(){this.hide()},scope:this}];GO.users.SettingsDialog.superclass.constructor.call(this,a)};Ext.extend(GO.users.SettingsDialog,Ext.Window,{show:function(){if(!this.rendered){this.render(Ext.getBody())}this.formPanel.load({url:GO.settings.modules.users.url+"json.php",params:{task:"settings"},waitMsg:GO.lang.waitMsgLoad,success:function(a,b){GO.users.SettingsDialog.superclass.show.call(this)},failure:function(a,b){Ext.Msg.alert(GO.lang.strError,b.result.feedback)},scope:this})},submitForm:function(a){this.formPanel.form.submit({url:GO.settings.modules.users.url+"action.php",params:{task:"save_settings"},waitMsg:GO.lang.waitMsgSave,success:function(b,c){if(a){this.hide()}},failure:function(b,c){if(c.failureType=="client"){Ext.MessageBox.alert(GO.lang.strError,GO.lang.strErrorsInForm)}else{Ext.MessageBox.alert(GO.lang.strError,c.result.feedback)}},scope:this})}});GO.users.MainPanel=function(b){if(!b){b={}}var a={fields:["id","username","name","company","logins","lastlogin","registration_time","address","address_no","zip","city","state","country","home_phone","email","waddress","waddress_no","wzip","wcity","wstate","wcountry","wphone","enabled"],columns:[{header:GO.lang.strUsername,dataIndex:"username",width:200},{header:GO.lang.strName,dataIndex:"name",width:250},{header:GO.lang.strCompany,dataIndex:"company",width:200},{header:GO.users.lang.numberOfLogins,dataIndex:"logins",width:100,align:"right"},{header:GO.users.lang.cmdFormLabelLastLogin,dataIndex:"lastlogin",width:100},{header:GO.users.lang.cmdFormLabelRegistrationTime,dataIndex:"registration_time",width:100},{header:GO.lang.strAddress,dataIndex:"address",hidden:true,width:150},{header:GO.lang.strAddressNo,dataIndex:"address_no",hidden:true,width:100},{header:GO.lang.strZip,dataIndex:"zip",hidden:true,width:100},{header:GO.lang.strCity,dataIndex:"city",hidden:true,width:100},{header:GO.lang.strState,dataIndex:"state",hidden:true,width:100},{header:GO.lang.strCountry,dataIndex:"country",hidden:true,width:100},{header:GO.lang.strPhone,dataIndex:"home_phone",hidden:true},{header:GO.lang.strEmail,dataIndex:"email",hidden:false,width:150},{header:GO.lang.strWorkAddress,dataIndex:"work_address",hidden:true,width:100},{header:GO.lang.strWorkAddressNo,dataIndex:"work_address_no",hidden:true,width:100},{header:GO.lang.strWorkZip,dataIndex:"work_zip",hidden:true},{header:GO.lang.strWorkCity,dataIndex:"work_city",hidden:true},{header:GO.lang.strWorkState,dataIndex:"work_state",hidden:true},{header:GO.lang.strWorkCountry,dataIndex:"work_country",hidden:true},{header:GO.lang.strWorkPhone,dataIndex:"work_phone",hidden:true}]};if(GO.customfields){GO.customfields.addColumns(8,a)}b.store=new GO.data.JsonStore({url:GO.settings.modules.users.url+"non_admin_json.php",baseParams:{task:"users"},id:"id",totalProperty:"total",root:"results",fields:a.fields,remoteSort:true});b.loadMask=true;b.store.setDefaultSort("username","ASC");this.searchField=new GO.form.SearchField({store:b.store,width:320});b.view=new Ext.grid.GridView({getRowClass:function(c,f,e,d){if(GO.util.empty(c.data.enabled)){return"user-disabled"}}});b.deleteConfig={extraWarning:GO.users.lang.deleteWarning+"\n\n"};b.cm=new Ext.grid.ColumnModel({defaults:{sortable:true},columns:a.columns});b.tbar=new Ext.Toolbar({cls:"go-head-tb",items:[{iconCls:"btn-add",text:GO.lang.cmdAdd,cls:"x-btn-text-icon",handler:function(){if(GO.settings.config.max_users>0&&this.store.totalLength>=GO.settings.config.max_users){Ext.Msg.alert(GO.lang.strError,GO.users.lang.maxUsersReached)}else{GO.users.showUserDialog()}},scope:this},{iconCls:"btn-delete",text:GO.lang.cmdDelete,cls:"x-btn-text-icon",handler:function(){this.deleteSelected()},scope:this},{iconCls:"btn-upload",text:GO.lang.cmdImport,handler:function(){if(!this.importDialog){this.importDialog=new GO.users.ImportDialog();this.importDialog.on("import",function(){this.store.reload()},this)}this.importDialog.show()},scope:this},{iconCls:"btn-settings",text:GO.lang.administration,handler:function(){if(!this.settingsDialog){this.settingsDialog=new GO.users.SettingsDialog()}this.settingsDialog.show()},scope:this},"-",GO.lang.strSearch+":",this.searchField]});if(GO.settings.config.max_users>0){b.bbar=new Ext.PagingToolbar({cls:"go-paging-tb",store:b.store,pageSize:parseInt(GO.settings.max_rows_list),displayInfo:true,displayMsg:GO.lang.displayingItems+". "+GO.lang.strMax+" "+GO.settings.config.max_users,emptyMsg:GO.lang.strNoItems})}b.sm=new Ext.grid.RowSelectionModel();b.paging=true;GO.users.MainPanel.superclass.constructor.call(this,b)};Ext.extend(GO.users.MainPanel,GO.grid.GridPanel,{afterRender:function(){GO.users.MainPanel.superclass.afterRender.call(this);this.on("rowdblclick",this.rowDoubleClick,this);this.store.load();GO.dialogListeners.add("user",{scope:this,save:function(){this.store.reload()}})},rowDoubleClick:function(c,e,d){var a=c.getSelectionModel();var b=a.getSelected();GO.users.showUserDialog(b.data.id)}});GO.users.showUserDialog=function(a,b){if(!GO.users.userDialog){GO.users.userDialog=new GO.users.UserDialog()}GO.users.userDialog.show(a,b)};GO.linkHandlers[8]=function(b){if(!GO.users.userLinkWindow){var a=new GO.users.UserPanel();GO.users.userLinkWindow=new GO.LinkViewWindow({title:GO.lang.strUser,closeAction:"hide",items:a,userPanel:a})}GO.users.userLinkWindow.userPanel.load(b);GO.users.userLinkWindow.show()};GO.linkPreviewPanels[8]=function(a){a=a||{};return new GO.users.UserPanel(a)};GO.moduleManager.addModule("users",GO.users.MainPanel,{title:GO.lang.users,iconCls:"go-tab-icon-users",admin:true});GO.users.UserPanel=Ext.extend(GO.DisplayPanel,{link_type:8,loadParams:{task:"user_with_items"},idParam:"user_id",loadUrl:GO.settings.modules.users.url+"json.php",editGoDialogId:"user",editHandler:function(){GO.users.showUserDialog(this.link_id)},initComponent:function(){this.template='<table class="display-panel" cellpadding="0" cellspacing="0" border="0"><tr><td colspan="2" class="display-panel-heading"><b>'+GO.lang.strUsername+': {username}</b></td></tr><tr><td valign="top"><table cellpadding="0" cellspacing="0" border="0"><tr><td>'+GO.lang.strName+":</td><td> {name}</td></tr><tr><td>"+GO.lang.strAddress+':</td><td><tpl if="!GO.util.empty(google_maps_link)"><a href="{google_maps_link}" target="_blank"></tpl>{formatted_address}<tpl if="!GO.util.empty(google_maps_link)"></a></tpl></td></tr><tpl if="!GO.util.empty(initials)"><tr><td>'+GO.lang.strInitials+':</td><td> {initials}</td></tr></tpl><tpl if="!GO.util.empty(birthday)"><tr><td>'+GO.lang.strBirthday+':</td><td> {birthday}</td></tr></tpl></table></td></tr><tpl if="this.isuserFieldset(values)"><tr><td colspan="2" class="display-panel-heading">'+GO.users.lang.contactInfo+'</td></tr><tr><td valign="top" class="userCompanyDetailsPanelKolom60"><table cellpadding="0" cellspacing="0" border="0"><tpl if="!GO.util.empty(email)"><tr><td class="userCompanyLabelWidth">'+GO.lang.strEmail+':</td><td>{[this.mailTo(values.email, values.full_name)]}</td></tr></tpl><tpl if="this.isPhoneFieldset(values)"><tr><td colspan="2">&nbsp;</td></tr><tpl if="!GO.util.empty(home_phone)"><tr><td class="userCompanyLabelWidth">'+GO.lang.strPhone+':</td><td><a href="{[GO.util.callToHref(values.home_phone)]}">{home_phone}</a></td></tr></tpl><tpl if="!GO.util.empty(cellular)"><tr><td class="userCompanyLabelWidth">'+GO.lang.strCellular+':</td><td><a href="{[GO.util.callToHref(values.cellular)]}">{cellular}</a></td></tr></tpl><tpl if="!GO.util.empty(fax)"><tr><td class="userCompanyLabelWidth">'+GO.lang.strFax+':</td><td>{fax}</td></tr></tpl></tpl></table></td><tpl if="this.isWorkPhoneFieldset(values)"><td valign="top" class="userCompanyDetailsPanelKolom40"><table cellpadding="0" cellspacing="0" border="0"><tpl if="!GO.util.empty(work_phone)"><tr><td class="userCompanyLabelWidth">'+GO.lang.strWorkPhone+':</td><td><a href="{[GO.util.callToHref(values.work_phone)]}">{work_phone}</a></td></tr></tpl><tpl if="!GO.util.empty(work_fax)"><tr><td class="userCompanyLabelWidth">'+GO.lang.strWorkFax+':</td><td>{work_fax}</td></tr></tpl></table></td></tpl></tr></tpl><tpl if="this.isWorkFieldset(values)"><tr><td colspan="2" class="display-panel-heading">Work</td></tr><tr><td colspan="2" valign="top" class="userCompanyDetailsPanelKolom60"><table cellpadding="0" cellspacing="0" border="0"><tpl if="!GO.util.empty(company)"><tr><td class="userCompanyLabelWidth">'+GO.lang.strCompany+':</td><td>{company}</a></td></tr></tpl><tpl if="!GO.util.empty(values[\'function\'])"><tr><td class="userCompanyLabelWidth">'+GO.lang.strFunction+':</td><td>{function}</td></tr></tpl><tpl if="!GO.util.empty(department)"><tr><td class="userCompanyLabelWidth">'+GO.lang.strDepartment+':</td><td>{department}</td></tr></tpl></table></td></tr></tpl><tpl if="!GO.util.empty(values[\'comment\'])"><tr><td class="display-panel-heading" colspan="2">'+GO.users.lang.cmdFormLabelComment+'</td></tr><tr><td colspan="2">{comment}</td></tr></tpl></table>'+GO.linksTemplate;if(GO.customfields){this.template+=GO.customfields.displayPanelTemplate}Ext.apply(this.templateConfig,{addSlashes:function(a){a=GO.util.html_entity_decode(a,"ENT_QUOTES");a=GO.util.add_slashes(a);return a},mailTo:function(b,a){if(GO.email&&GO.settings.modules.email.read_permission){return'<a href="#" onclick="GO.email.showAddressMenu(event, \''+this.addSlashes(b)+"','"+this.addSlashes(a)+"');\">"+b+"</a>"}else{return'<a href="mailto:'+b+'">'+b+"</a>"}},isuserFieldset:function(a){if(!GO.util.empty(a.email)||!GO.util.empty(a.home_phone)||!GO.util.empty(a.fax)||!GO.util.empty(a.cellular)||!GO.util.empty(a.work_phone)||!GO.util.empty(a.work_fax)){return true}else{return false}},isPhoneFieldset:function(a){if(!GO.util.empty(a.home_phone)||!GO.util.empty(a.fax)||!GO.util.empty(a.cellular)){return true}else{return false}},isWorkPhoneFieldset:function(a){if(!GO.util.empty(a.work_phone)||!GO.util.empty(a.work_fax)){return true}else{return false}},isWorkFieldset:function(a){if(!GO.util.empty(a.company)||!GO.util.empty(a["function"])||!GO.util.empty(a.department)){return true}else{return false}},GoogleMapsCityStreet:function(a){var b="http://maps.google.com/maps?q=";if(!GO.util.empty(a.address)&&!GO.util.empty(a.city)){if(!GO.util.empty(a.address_no)){return'<a href="'+b+a.address+"+"+a.address_no+"+"+a.city+'" target="_blank" >'+a.address+" "+a.address_no+"</a>"}else{return'<a href="'+b+a.address+"+"+a.city+'" target="_blank" >'+a.address+"</a>"}}else{return a.address+" "+a.address_no}}});Ext.apply(this.templateConfig,GO.linksTemplateConfig);if(GO.files){Ext.apply(this.templateConfig,GO.files.filesTemplateConfig);this.template+=GO.files.filesTemplate}if(GO.comments){this.template+=GO.comments.displayPanelTemplate}GO.users.UserPanel.superclass.initComponent.call(this);if(GO.documenttemplates){this.newOODoc=new GO.documenttemplates.NewOODocumentMenuItem();this.newOODoc.on("create",function(){this.reload()},this);this.newMenuButton.menu.add(this.newOODoc);GO.documenttemplates.ooTemplatesStore.on("load",function(){this.newOODoc.setDisabled(GO.documenttemplates.ooTemplatesStore.getCount()==0)},this)}if(GO.tasks){this.scheduleCallItem=new GO.tasks.ScheduleCallMenuItem();this.newMenuButton.menu.add(this.scheduleCallItem)}},getLinkName:function(){return this.data.full_name},setData:function(b){GO.users.UserPanel.superclass.setData.call(this,b);if(GO.documenttemplates&&!GO.documenttemplates.ooTemplatesStore.loaded){GO.documenttemplates.ooTemplatesStore.load()}if(b.write_permission){if(this.scheduleCallItem){var a=this.data.full_name;if(this.data.work_phone!=""){a+=" ("+this.data.work_phone+")"}else{if(this.data.cellular!=""){a+=" ("+this.data.cellular+")"}else{if(this.data.home_phone!=""){a+=" ("+this.data.home_phone+")"}}}this.scheduleCallItem.setLinkConfig({name:a,links:[{link_id:this.data.id,link_type:2}],callback:this.reload,scope:this})}}}});