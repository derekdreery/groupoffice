<?php
/*if(isset($argv[1]))
{
	define('CONFIG_FILE', $argv[1]);
}*/


require('../../www/Group-Office.php');

$xml = '<?xml version="1.0" encoding="UTF-8"?>
<office:document-content xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:style="urn:oasis:names:tc:opendocument:xmlns:style:1.0" xmlns:text="urn:oasis:names:tc:opendocument:xmlns:text:1.0" xmlns:table="urn:oasis:names:tc:opendocument:xmlns:table:1.0" xmlns:draw="urn:oasis:names:tc:opendocument:xmlns:drawing:1.0" xmlns:fo="urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:number="urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0" xmlns:svg="urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0" xmlns:chart="urn:oasis:names:tc:opendocument:xmlns:chart:1.0" xmlns:dr3d="urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0" xmlns:math="http://www.w3.org/1998/Math/MathML" xmlns:form="urn:oasis:names:tc:opendocument:xmlns:form:1.0" xmlns:script="urn:oasis:names:tc:opendocument:xmlns:script:1.0" xmlns:ooo="http://openoffice.org/2004/office" xmlns:ooow="http://openoffice.org/2004/writer" xmlns:oooc="http://openoffice.org/2004/calc" xmlns:dom="http://www.w3.org/2001/xml-events" xmlns:xforms="http://www.w3.org/2002/xforms" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:rpt="http://openoffice.org/2005/report" xmlns:of="urn:oasis:names:tc:opendocument:xmlns:of:1.2" xmlns:rdfa="http://docs.oasis-open.org/opendocument/meta/rdfa#" xmlns:field="urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0" office:version="1.2"><office:scripts/><office:font-face-decls><style:font-face style:name="Tahoma1" svg:font-family="Tahoma"/><style:font-face style:name="LTErgo1" svg:font-family="LTErgo" style:font-pitch="variable"/><style:font-face style:name="LTErgo" svg:font-family="LTErgo" style:font-adornments="Standaard" style:font-pitch="variable"/><style:font-face style:name="Lucida Sans Unicode" svg:font-family="&apos;Lucida Sans Unicode&apos;" style:font-pitch="variable"/><style:font-face style:name="Tahoma" svg:font-family="Tahoma" style:font-pitch="variable"/><style:font-face style:name="Times New Roman" svg:font-family="&apos;Times New Roman&apos;" style:font-family-generic="roman" style:font-pitch="variable"/><style:font-face style:name="Arial" svg:font-family="Arial" style:font-family-generic="swiss" style:font-pitch="variable"/></office:font-face-decls><office:automatic-styles><style:style style:name="P1" style:family="paragraph" style:parent-style-name="Standard"><style:text-properties style:font-name="LTErgo1" fo:font-size="10pt" style:font-size-asian="10pt" style:font-size-complex="10pt"/></style:style><style:style style:name="P2" style:family="paragraph" style:parent-style-name="Standard"><style:text-properties fo:font-size="8pt" style:font-size-asian="8pt" style:font-size-complex="8pt"/></style:style><style:style style:name="T1" style:family="text"><style:text-properties style:font-name="LTErgo1"/></style:style><style:style style:name="T2" style:family="text"><style:text-properties style:font-name="LTErgo1" fo:font-size="10pt" style:font-size-asian="10pt" style:font-size-complex="10pt"/></style:style></office:automatic-styles><office:body><office:text><office:forms form:automatic-focus="false" form:apply-design-mode="false"/><text:sequence-decls><text:sequence-decl text:display-outline-level="0" text:name="Illustration"/><text:sequence-decl text:display-outline-level="0" text:name="Table"/><text:sequence-decl text:display-outline-level="0" text:name="Text"/><text:sequence-decl text:display-outline-level="0" text:name="Drawing"/></text:sequence-decls><text:p text:style-name="Standard"><text:tab/><text:tab/><text:tab/><text:tab/><text:tab/>{company}</text:p><text:p text:style-name="Standard"><text:tab/><text:tab/><text:tab/><text:tab/><text:tab/>t.a.v. {<text:span text:style-name="T2">initials} {middle_name} {last_name} </text:span></text:p><text:p text:style-name="Standard"><text:tab/><text:tab/><text:tab/><text:tab/><text:tab/>{<text:span text:style-name="T2">work_post_address} {work_post_address_no} </text:span></text:p><text:p text:style-name="Standard"><text:tab/><text:tab/><text:tab/><text:tab/><text:tab/>{<text:span text:style-name="T2">work_post_zip} <text:s/>{work_post_city} </text:span></text:p><text:p text:style-name="P1"/><text:p text:style-name="P1"/><text:p text:style-name="Standard"/><text:p text:style-name="Standard"/><text:p text:style-name="Standard"/><text:p text:style-name="P2">kenmerk:<text:tab/></text:p><text:p text:style-name="P2">betreft:<text:tab/></text:p><text:p text:style-name="P2">datum:<text:tab/>{<text:span text:style-name="T1">date} </text:span></text:p><text:p text:style-name="Standard"/><text:p text:style-name="Standard"/><text:p text:style-name="Standard"/><text:p text:style-name="Standard"/><text:p text:style-name="Standard">Geachte {<text:span text:style-name="T2">beginning} {middle_name} {last_name},</text:span></text:p><text:p text:style-name="Standard"/><text:p text:style-name="P1">Hierbij ontvangt u.....<text:tab/><text:tab/><text:tab/><text:tab/><text:tab/><text:tab/></text:p><text:p text:style-name="P1"/><text:p text:style-name="P1"/><text:p text:style-name="P1">Wij vertrouwen erop u hiermee voldoende te hebben ge√Ønformeerd.</text:p><text:p text:style-name="P1"/><text:p text:style-name="P1">Timek bouwmanagement</text:p><text:p text:style-name="P1"/><text:p text:style-name="P1">{my_name} </text:p><text:p text:style-name="P1"/><text:p text:style-name="P1"/></office:text></office:body></office:document-content>';

$xml = preg_replace('/{([^}]*)}/Ue', "replacetag('$1')", $xml);

function replacetag($tag){
	//some times there are XML tags inside the GO template tag.
	//place them outside the tag.
	preg_match('/<[^>]*>/',$tag,$matches);
	return implode('', $matches).'{'.strip_tags($tag).'}';
}

echo $xml;
?>
